#!/bin/bash
# wp_smtp_info.sh
# –í–∏–≤–æ–¥–∏—Ç—å –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è SMTP WordPress —É —Ñ–æ—Ä–º–∞—Ç–æ–≤–∞–Ω–æ–º—É –≤–∏–≥–ª—è–¥—ñ
# –ó–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è –∑ –∫–æ—Ä–µ–Ω–µ–≤–æ—ó –ø–∞–ø–∫–∏ WordPress

# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ wp-cli
if ! command -v wp &>/dev/null; then
    echo "‚ùå wp-cli –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ"
    exit 1
fi

# –û—Ç—Ä–∏–º—É—î–º–æ –¥–∞–Ω—ñ SMTP —É —Ñ–æ—Ä–º–∞—Ç—ñ JSON
SMTP_JSON=$(wp option get wp_mail_smtp --format=json)

if [ -z "$SMTP_JSON" ]; then
    echo "‚ö†Ô∏è –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è wp_mail_smtp –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ"
    exit 0
fi

# –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ jq –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–æ–≤–∞–Ω–æ–≥–æ –≤–∏–≤–æ–¥—É (—è–∫—â–æ –Ω–µ–º–∞—î jq, –º–æ–∂–Ω–∞ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏)
if ! command -v jq &>/dev/null; then
    echo "‚ö†Ô∏è –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ jq –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–æ–≤–∞–Ω–æ–≥–æ –≤–∏–≤–æ–¥—É"
    echo "–°–∏—Ä–æ–≤—ñ –¥–∞–Ω—ñ JSON:"
    echo "$SMTP_JSON"
    exit 0
fi

# –í–∏–≤–æ–¥–∏–º–æ –∫–ª—é—á–æ–≤—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
echo "======================================"
echo "üîπ –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è SMTP WordPress"
echo "======================================"
echo "SMTP —Å–µ—Ä–≤–µ—Ä:       $(echo "$SMTP_JSON" | jq -r '.mailer.smtp.host // "–Ω–µ –∑–∞–¥–∞–Ω–æ")')"
echo "SMTP –ø–æ—Ä—Ç:         $(echo "$SMTP_JSON" | jq -r '.mailer.smtp.port // "–Ω–µ –∑–∞–¥–∞–Ω–æ")')"
echo "–®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è:        $(echo "$SMTP_JSON" | jq -r '.mailer.smtp.encryption // "–Ω–µ –∑–∞–¥–∞–Ω–æ")')"
echo "–õ–æ–≥—ñ–Ω (username):  $(echo "$SMTP_JSON" | jq -r '.mailer.smtp.username // "–Ω–µ –∑–∞–¥–∞–Ω–æ")')"
echo "Email –≤—ñ–¥–ø—Ä–∞–≤–Ω–∏–∫–∞: $(echo "$SMTP_JSON" | jq -r '.from_email // "–Ω–µ –∑–∞–¥–∞–Ω–æ")')"
echo "–Ü–º'—è –≤—ñ–¥–ø—Ä–∞–≤–Ω–∏–∫–∞:  $(echo "$SMTP_JSON" | jq -r '.from_name // "–Ω–µ –∑–∞–¥–∞–Ω–æ")')"
echo "======================================"
